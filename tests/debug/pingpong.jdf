extern "C" %{
#include "dplasma.h"

extern double *_A;

#define A(n) _A

%}

rowRANK
colRANK
GRIDrows
GRIDcols
NT

PING(k)

k = 0 .. NT
: ((0*k) + 0) == rowRANK
: 0*k == colRANK

INOUT T <- (k==0) ? A(0) : I PONG(k-1)
        -> (k==NT) ? A(0) : I PONG(k)

BODY
/* no body */
#if defined(DPLASMA_DEBUG)
printf("PING(%d) on %d\n", k, rowRANK);
#endif
END


PONG(k)

k = 0 .. NT-1
: ((0*k) + 1) == rowRANK
: 0*k         == colRANK

INOUT I <- T PING(k)
        -> T PING(k+1)

BODY
/* no body */
#if defined(DPLASMA_DEBUG)
printf("PONG(%d) on %d\n", k, rowRANK);
#endif
END
