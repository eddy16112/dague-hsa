extern "C" %{
/*
 * Copyright (c) 2015      The University of Tennessee and The University
 *                         of Tennessee Research Foundation.  All rights
 *                         reserved.
 */
#include "data_dist/matrix/matrix.h"

%}

/* Globals
 */
dataA      [type = "dague_ddesc_t *"]
descA      [type = "tiled_matrix_desc_t" hidden = on default = "*((tiled_matrix_desc_t*)dataA)"]

PING(k)

// Execution space
k = 0 .. descA.nt-1

// Parallel partitioning
:dataA(0, 0)

// Parameters
RW A <- k==0 ? dataA(0, 0) : A PONG(k-1)
     -> k<descA.nt-1 ? A PONG(k)
RW B <- k==0 ? dataA(0, 0) : B PONG(k-1)
     -> k<descA.nt-1 ? B PONG(k)
BODY
printf("_-^^-__-^^-__ PING %d\n", k);
END

PONG(k)
k = 0 .. descA.nt-2

:dataA(0,1)

READ A <- A PING(k)
       -> A PING(k+1)
READ B <- B PING(k)
       -> B PING(k+1)

BODY
printf("_-^^-__-^^-__ PONG %d\n", k);
END

